<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>SphinxBase: include/pio.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>include/pio.h File Reference</h1>file IO related operations.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;sys/stat.h&gt;</code><br>
<code>#include &lt;sphinxbase_export.h&gt;</code><br>
<code>#include &lt;<a class="el" href="prim__type_8h-source.html">prim_type.h</a>&gt;</code><br>

<p>
<a href="pio_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlineiter__t.html">lineiter_t</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Line iterator for files.  <a href="structlineiter__t.html#_details">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="96b37e449c7f8698fcfafac1c46cebb2"></a><!-- doxytag: member="pio.h::myfopen" ref="96b37e449c7f8698fcfafac1c46cebb2" args="(file, mode)" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>myfopen</b>(file, mode)&nbsp;&nbsp;&nbsp;_myfopen((file),(mode),__FILE__,__LINE__)</td></tr>

<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e72c3bec19638da72dad3849f75c0cd9"></a><!-- doxytag: member="pio.h::bit_encode_t" ref="e72c3bec19638da72dad3849f75c0cd9" args="" -->
typedef struct bit_encode_s&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pio_8h.html#e72c3bec19638da72dad3849f75c0cd9">bit_encode_t</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Bitstream encoder - for writing compressed files. <br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SPHINXBASE_EXPORT FILE *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pio_8h.html#a3d71506049eb49cf03eff1b89ef281f">fopen_comp</a> (const char *file, const char *mode, int32 *ispipe)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Like fopen, but use popen and zcat if it is determined that "file" is compressed (i.e., has a .z, .Z, .gz, or .GZ extension).  <a href="#a3d71506049eb49cf03eff1b89ef281f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SPHINXBASE_EXPORT void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pio_8h.html#87592c3a2d0a00eed9eda014950beb65">fclose_comp</a> (FILE *fp, int32 ispipe)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Close a file opened using fopen_comp.  <a href="#87592c3a2d0a00eed9eda014950beb65"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SPHINXBASE_EXPORT FILE *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pio_8h.html#ddfd26392f118f811584721b8d4854ce">fopen_compchk</a> (const char *file, int32 *ispipe)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Open a file for reading, but if file not present try to open compressed version (if file is uncompressed, and vice versa).  <a href="#ddfd26392f118f811584721b8d4854ce"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a22301f25d56be607c9ff45f2c935b14"></a><!-- doxytag: member="pio.h::_myfopen" ref="a22301f25d56be607c9ff45f2c935b14" args="(const char *file, const char *mode, const char *pgm, int32 line)" -->
SPHINXBASE_EXPORT FILE *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pio_8h.html#a22301f25d56be607c9ff45f2c935b14">_myfopen</a> (const char *file, const char *mode, const char *pgm, int32 line)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Wrapper around fopen to check for failure and E_FATAL if failed. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SPHINXBASE_EXPORT int32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pio_8h.html#601277430d3221bf1906bb879ae26d3e">fread_retry</a> (void *pointer, int32 size, int32 num_items, FILE *stream)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">NFS file reads seem to fail now and then.  <a href="#601277430d3221bf1906bb879ae26d3e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SPHINXBASE_EXPORT char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pio_8h.html#11e0daa4f315d01c2e030d3a0abe702c">fread_line</a> (FILE *stream, size_t *out_len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read a line of arbitrary length from a file and return it as a newly allocated string.  <a href="#11e0daa4f315d01c2e030d3a0abe702c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="22d0125ab198f02f8bbe543417d99566"></a><!-- doxytag: member="pio.h::lineiter_start" ref="22d0125ab198f02f8bbe543417d99566" args="(FILE *fh)" -->
SPHINXBASE_EXPORT <a class="el" href="structlineiter__t.html">lineiter_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pio_8h.html#22d0125ab198f02f8bbe543417d99566">lineiter_start</a> (FILE *fh)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Start reading lines from a file. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ff8df0b6928746d61b3520555263f71e"></a><!-- doxytag: member="pio.h::lineiter_next" ref="ff8df0b6928746d61b3520555263f71e" args="(lineiter_t *li)" -->
SPHINXBASE_EXPORT <a class="el" href="structlineiter__t.html">lineiter_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pio_8h.html#ff8df0b6928746d61b3520555263f71e">lineiter_next</a> (<a class="el" href="structlineiter__t.html">lineiter_t</a> *li)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Move to the next line in the file. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3f80e5d4d666426cef229dd41237d9cf"></a><!-- doxytag: member="pio.h::lineiter_free" ref="3f80e5d4d666426cef229dd41237d9cf" args="(lineiter_t *li)" -->
SPHINXBASE_EXPORT void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pio_8h.html#3f80e5d4d666426cef229dd41237d9cf">lineiter_free</a> (<a class="el" href="structlineiter__t.html">lineiter_t</a> *li)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stop reading lines from a file. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="82e4694a4c13c96550f2410f8c63b1f5"></a><!-- doxytag: member="pio.h::bit_encode_attach" ref="82e4694a4c13c96550f2410f8c63b1f5" args="(FILE *outfh)" -->
<a class="el" href="pio_8h.html#e72c3bec19638da72dad3849f75c0cd9">bit_encode_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pio_8h.html#82e4694a4c13c96550f2410f8c63b1f5">bit_encode_attach</a> (FILE *outfh)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Attach bitstream encoder to a file. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="da6d9bb75e08493cde00d396dae088f1"></a><!-- doxytag: member="pio.h::bit_encode_retain" ref="da6d9bb75e08493cde00d396dae088f1" args="(bit_encode_t *be)" -->
<a class="el" href="pio_8h.html#e72c3bec19638da72dad3849f75c0cd9">bit_encode_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pio_8h.html#da6d9bb75e08493cde00d396dae088f1">bit_encode_retain</a> (<a class="el" href="pio_8h.html#e72c3bec19638da72dad3849f75c0cd9">bit_encode_t</a> *be)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retain pointer to a bit encoder. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pio_8h.html#8330637520174419771670ed740c9049">bit_encode_free</a> (<a class="el" href="pio_8h.html#e72c3bec19638da72dad3849f75c0cd9">bit_encode_t</a> *be)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Release pointer to a bit encoder.  <a href="#8330637520174419771670ed740c9049"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="59d83bd5850d9ec58175c566d6d48f71"></a><!-- doxytag: member="pio.h::bit_encode_write" ref="59d83bd5850d9ec58175c566d6d48f71" args="(bit_encode_t *be, unsigned char const *bits, int nbits)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pio_8h.html#59d83bd5850d9ec58175c566d6d48f71">bit_encode_write</a> (<a class="el" href="pio_8h.html#e72c3bec19638da72dad3849f75c0cd9">bit_encode_t</a> *be, unsigned char const *bits, int nbits)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write bits to encoder. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e71dedb663c8e3ae8b91dbfbc95ac420"></a><!-- doxytag: member="pio.h::bit_encode_write_cw" ref="e71dedb663c8e3ae8b91dbfbc95ac420" args="(bit_encode_t *be, uint32 codeword, int nbits)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pio_8h.html#e71dedb663c8e3ae8b91dbfbc95ac420">bit_encode_write_cw</a> (<a class="el" href="pio_8h.html#e72c3bec19638da72dad3849f75c0cd9">bit_encode_t</a> *be, uint32 codeword, int nbits)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write lowest-order bits of codeword to encoder. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3e818645e567961225977a1923debc3d"></a><!-- doxytag: member="pio.h::bit_encode_flush" ref="3e818645e567961225977a1923debc3d" args="(bit_encode_t *be)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pio_8h.html#3e818645e567961225977a1923debc3d">bit_encode_flush</a> (<a class="el" href="pio_8h.html#e72c3bec19638da72dad3849f75c0cd9">bit_encode_t</a> *be)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flush any unwritten bits, zero-padding if necessary. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SPHINXBASE_EXPORT int32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pio_8h.html#0ba35509687e80ee65ba731c7cfcad9b">stat_retry</a> (const char *file, struct stat *statbuf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">There is no bitstream decoder, because a stream abstraction is too slow.  <a href="#0ba35509687e80ee65ba731c7cfcad9b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="289e3a1582ab60563ae0689979992669"></a><!-- doxytag: member="pio.h::stat_mtime" ref="289e3a1582ab60563ae0689979992669" args="(const char *file)" -->
SPHINXBASE_EXPORT int32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pio_8h.html#289e3a1582ab60563ae0689979992669">stat_mtime</a> (const char *file)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return time of last modification for the given file, or -1 if stat fails. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SPHINXBASE_EXPORT int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pio_8h.html#6df697b8a08cd4d11fe7b864dcb99012">build_directory</a> (const char *path)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a directory and all of its parent directories, as needed.  <a href="#6df697b8a08cd4d11fe7b864dcb99012"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
file IO related operations. 
<p>
Custom fopen with error checking is implemented. fopen_comp can open a file with .z, .Z, .gz or .GZ extension<p>
WARNING: Usage of stat_retry will results in 100s of waiting time if the file doesn't exist. 
<p>Definition in file <a class="el" href="pio_8h-source.html">pio.h</a>.</p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="8330637520174419771670ed740c9049"></a><!-- doxytag: member="pio.h::bit_encode_free" ref="8330637520174419771670ed740c9049" args="(bit_encode_t *be)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int bit_encode_free           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pio_8h.html#e72c3bec19638da72dad3849f75c0cd9">bit_encode_t</a> *&nbsp;</td>
          <td class="paramname"> <em>be</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Release pointer to a bit encoder. 
<p>
Note that this does NOT flush any leftover bits. 
<p>Definition at line <a class="el" href="pio_8c-source.html#l00502">502</a> of file <a class="el" href="pio_8c-source.html">pio.c</a>.</p>

<p>References <a class="el" href="pio_8c-source.html#l00502">bit_encode_free()</a>, and <a class="el" href="ckd__alloc_8c-source.html#l00241">ckd_free()</a>.</p>

<p>Referenced by <a class="el" href="pio_8c-source.html#l00502">bit_encode_free()</a>, and <a class="el" href="huff__code_8c-source.html#l00486">huff_code_detach()</a>.</p>

</div>
</div><p>
<a class="anchor" name="6df697b8a08cd4d11fe7b864dcb99012"></a><!-- doxytag: member="pio.h::build_directory" ref="6df697b8a08cd4d11fe7b864dcb99012" args="(const char *path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SPHINXBASE_EXPORT int build_directory           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>path</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create a directory and all of its parent directories, as needed. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, &lt;0 on failure. </dd></dl>

<p>Definition at line <a class="el" href="pio_8c-source.html#l00599">599</a> of file <a class="el" href="pio_8c-source.html">pio.c</a>.</p>

<p>References <a class="el" href="pio_8c-source.html#l00599">build_directory()</a>, and <a class="el" href="err_8h-source.html#l00181">E_ERROR</a>.</p>

<p>Referenced by <a class="el" href="pio_8c-source.html#l00599">build_directory()</a>.</p>

</div>
</div><p>
<a class="anchor" name="87592c3a2d0a00eed9eda014950beb65"></a><!-- doxytag: member="pio.h::fclose_comp" ref="87592c3a2d0a00eed9eda014950beb65" args="(FILE *fp, int32 ispipe)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SPHINXBASE_EXPORT void fclose_comp           </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&nbsp;</td>
          <td class="paramname"> <em>ispipe</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Close a file opened using fopen_comp. 
<p>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>fp</em>&nbsp;</td><td>
In: File pointer to be closed </td></tr>
<tr><td valign="top"><em>ispipe</em>&nbsp;</td><td>
In: ispipe argument that was returned by the corresponding <a class="el" href="pio_8h.html#a3d71506049eb49cf03eff1b89ef281f" title="Like fopen, but use popen and zcat if it is determined that &quot;file&quot; is compressed...">fopen_comp()</a> call </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="pio_8c-source.html#l00175">175</a> of file <a class="el" href="pio_8c-source.html">pio.c</a>.</p>

<p>References <a class="el" href="pio_8c-source.html#l00175">fclose_comp()</a>.</p>

<p>Referenced by <a class="el" href="pio_8c-source.html#l00175">fclose_comp()</a>.</p>

</div>
</div><p>
<a class="anchor" name="a3d71506049eb49cf03eff1b89ef281f"></a><!-- doxytag: member="pio.h::fopen_comp" ref="a3d71506049eb49cf03eff1b89ef281f" args="(const char *file, const char *mode, int32 *ispipe)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SPHINXBASE_EXPORT FILE* fopen_comp           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32 *&nbsp;</td>
          <td class="paramname"> <em>ispipe</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Like fopen, but use popen and zcat if it is determined that "file" is compressed (i.e., has a .z, .Z, .gz, or .GZ extension). 
<p>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>file</em>&nbsp;</td><td>
In: File to be opened </td></tr>
<tr><td valign="top"><em>mode</em>&nbsp;</td><td>
In: "r" or "w", as with normal fopen </td></tr>
<tr><td valign="top"><em>ispipe</em>&nbsp;</td><td>
Out: On return *ispipe is TRUE iff file was opened via a pipe </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="pio_8c-source.html#l00098">98</a> of file <a class="el" href="pio_8c-source.html">pio.c</a>.</p>

<p>References <a class="el" href="ckd__alloc_8c-source.html#l00241">ckd_free()</a>, <a class="el" href="err_8h-source.html#l00181">E_ERROR</a>, <a class="el" href="err_8h-source.html#l00154">E_ERROR_SYSTEM</a>, <a class="el" href="err_8h-source.html#l00139">E_FATAL</a>, <a class="el" href="pio_8c-source.html#l00098">fopen_comp()</a>, and <a class="el" href="strfuncs_8c-source.html#l00062">string_join()</a>.</p>

<p>Referenced by <a class="el" href="pio_8c-source.html#l00098">fopen_comp()</a>, and <a class="el" href="pio_8c-source.html#l00192">fopen_compchk()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ddfd26392f118f811584721b8d4854ce"></a><!-- doxytag: member="pio.h::fopen_compchk" ref="ddfd26392f118f811584721b8d4854ce" args="(const char *file, int32 *ispipe)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SPHINXBASE_EXPORT FILE* fopen_compchk           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32 *&nbsp;</td>
          <td class="paramname"> <em>ispipe</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Open a file for reading, but if file not present try to open compressed version (if file is uncompressed, and vice versa). 
<p>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>file</em>&nbsp;</td><td>
In: File to be opened </td></tr>
<tr><td valign="top"><em>ispipe</em>&nbsp;</td><td>
Out: On return *ispipe is TRUE iff file was opened via a pipe </td></tr>
</table>
</dl>
<p>Definition at line <a class="el" href="pio_8c-source.html#l00192">192</a> of file <a class="el" href="pio_8c-source.html">pio.c</a>.</p>

<p>References <a class="el" href="ckd__alloc_8h-source.html#l00230">ckd_calloc</a>, <a class="el" href="ckd__alloc_8c-source.html#l00241">ckd_free()</a>, <a class="el" href="err_8h-source.html#l00176">E_WARN</a>, <a class="el" href="pio_8c-source.html#l00098">fopen_comp()</a>, and <a class="el" href="pio_8c-source.html#l00192">fopen_compchk()</a>.</p>

<p>Referenced by <a class="el" href="pio_8c-source.html#l00192">fopen_compchk()</a>.</p>

</div>
</div><p>
<a class="anchor" name="11e0daa4f315d01c2e030d3a0abe702c"></a><!-- doxytag: member="pio.h::fread_line" ref="11e0daa4f315d01c2e030d3a0abe702c" args="(FILE *stream, size_t *out_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SPHINXBASE_EXPORT char* fread_line           </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>out_len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read a line of arbitrary length from a file and return it as a newly allocated string. 
<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000028">Deprecated:</a></b></dt><dd>Use line iterators instead.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>stream</em>&nbsp;</td><td>The file handle to read from. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>out_len</em>&nbsp;</td><td>Output: if not NULL, length of the string read. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>allocated string containing the line, or NULL on error or EOF. </dd></dl>

<p>Definition at line <a class="el" href="pio_8c-source.html#l00312">312</a> of file <a class="el" href="pio_8c-source.html">pio.c</a>.</p>

<p>References <a class="el" href="ckd__alloc_8h-source.html#l00235">ckd_malloc</a>, <a class="el" href="ckd__alloc_8h-source.html#l00240">ckd_realloc</a>, and <a class="el" href="pio_8c-source.html#l00312">fread_line()</a>.</p>

<p>Referenced by <a class="el" href="pio_8c-source.html#l00312">fread_line()</a>, and <a class="el" href="huff__code_8c-source.html#l00309">huff_code_read()</a>.</p>

</div>
</div><p>
<a class="anchor" name="601277430d3221bf1906bb879ae26d3e"></a><!-- doxytag: member="pio.h::fread_retry" ref="601277430d3221bf1906bb879ae26d3e" args="(void *pointer, int32 size, int32 num_items, FILE *stream)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SPHINXBASE_EXPORT int32 fread_retry           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>pointer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&nbsp;</td>
          <td class="paramname"> <em>num_items</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>stream</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
NFS file reads seem to fail now and then. 
<p>
Use the following functions in place of the regular fread. It retries failed freads several times and quits only if all of them fail. Be aware, however, that even normal failures such as attempting to read beyond EOF will trigger such retries, wasting about a minute in retries. Arguments identical to regular fread. 
<p>Definition at line <a class="el" href="pio_8c-source.html#l00344">344</a> of file <a class="el" href="pio_8c-source.html">pio.c</a>.</p>

<p>References <a class="el" href="err_8h-source.html#l00154">E_ERROR_SYSTEM</a>, and <a class="el" href="pio_8c-source.html#l00344">fread_retry()</a>.</p>

<p>Referenced by <a class="el" href="feat_8c-source.html#l00360">feat_s2mfc_read()</a>, and <a class="el" href="pio_8c-source.html#l00344">fread_retry()</a>.</p>

</div>
</div><p>
<a class="anchor" name="0ba35509687e80ee65ba731c7cfcad9b"></a><!-- doxytag: member="pio.h::stat_retry" ref="0ba35509687e80ee65ba731c7cfcad9b" args="(const char *file, struct stat *statbuf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SPHINXBASE_EXPORT int32 stat_retry           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct stat *&nbsp;</td>
          <td class="paramname"> <em>statbuf</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
There is no bitstream decoder, because a stream abstraction is too slow. 
<p>
Instead we read blocks of bits and treat them as bitvectors. Like fread_retry, but for stat. Arguments identical to regular stat. Return value: 0 if successful, -1 if stat failed several attempts. 
<p>Definition at line <a class="el" href="pio_8c-source.html#l00426">426</a> of file <a class="el" href="pio_8c-source.html">pio.c</a>.</p>

<p>References <a class="el" href="err_8h-source.html#l00154">E_ERROR_SYSTEM</a>, and <a class="el" href="pio_8c-source.html#l00426">stat_retry()</a>.</p>

<p>Referenced by <a class="el" href="feat_8c-source.html#l00360">feat_s2mfc_read()</a>, <a class="el" href="pio_8c-source.html#l00461">stat_mtime()</a>, and <a class="el" href="pio_8c-source.html#l00426">stat_retry()</a>.</p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sat Dec 3 20:28:39 2011 for SphinxBase by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.7.1 </small></address>
</body>
</html>
