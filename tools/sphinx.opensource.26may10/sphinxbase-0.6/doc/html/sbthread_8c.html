<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>SphinxBase: src/libsphinxbase/util/sbthread.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>src/libsphinxbase/util/sbthread.c File Reference</h1>Simple portable thread functions.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &quot;<a class="el" href="sbthread_8h-source.html">sbthread.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="ckd__alloc_8h-source.html">ckd_alloc.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="err_8h-source.html">err.h</a>&quot;</code><br>
<code>#include &lt;pthread.h&gt;</code><br>
<code>#include &lt;sys/time.h&gt;</code><br>

<p>
<a href="sbthread_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><b>sbthread_s</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><b>sbmsgq_s</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><b>sbevent_s</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><b>sbmtx_s</b></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0ba06f52feda5c218dc38373e930017c"></a><!-- doxytag: member="sbthread.c::sbthread_start" ref="0ba06f52feda5c218dc38373e930017c" args="(cmd_ln_t *config, sbthread_main func, void *arg)" -->
<a class="el" href="sbthread_8h.html#068f6028c760eee1e4eb4655ac7e7424">sbthread_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sbthread_8c.html#0ba06f52feda5c218dc38373e930017c">sbthread_start</a> (<a class="el" href="structcmd__ln__t.html">cmd_ln_t</a> *config, <a class="el" href="sbthread_8h.html#cb30b2ddcf70058f8bd38d68920be777">sbthread_main</a> func, void *arg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Start a new thread. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d4cc725834be72ea986f80c4f4ecb24d"></a><!-- doxytag: member="sbthread.c::sbthread_wait" ref="d4cc725834be72ea986f80c4f4ecb24d" args="(sbthread_t *th)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sbthread_8c.html#d4cc725834be72ea986f80c4f4ecb24d">sbthread_wait</a> (<a class="el" href="sbthread_8h.html#068f6028c760eee1e4eb4655ac7e7424">sbthread_t</a> *th)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Wait for a thread to complete. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="sbthread_8h.html#ad7adcc2e5f2fd6d2f429c25a52356ef">sbmsgq_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sbthread_8c.html#76852d201655b6f08ed6c35f6ebf8b4b">sbmsgq_init</a> (size_t depth)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a message queue.  <a href="#76852d201655b6f08ed6c35f6ebf8b4b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a8483d06a1456207643abcfebc3b2e0a"></a><!-- doxytag: member="sbthread.c::sbmsgq_free" ref="a8483d06a1456207643abcfebc3b2e0a" args="(sbmsgq_t *msgq)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sbthread_8c.html#a8483d06a1456207643abcfebc3b2e0a">sbmsgq_free</a> (<a class="el" href="sbthread_8h.html#ad7adcc2e5f2fd6d2f429c25a52356ef">sbmsgq_t</a> *msgq)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free a message queue. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e6c214bf1fab2f10cb51648b7e736698"></a><!-- doxytag: member="sbthread.c::sbmsgq_send" ref="e6c214bf1fab2f10cb51648b7e736698" args="(sbmsgq_t *q, size_t len, void const *data)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sbthread_8c.html#e6c214bf1fab2f10cb51648b7e736698">sbmsgq_send</a> (<a class="el" href="sbthread_8h.html#ad7adcc2e5f2fd6d2f429c25a52356ef">sbmsgq_t</a> *q, size_t len, void const *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Post a message to a queue. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5ef0a82190db1efc97e5921d2f822535"></a><!-- doxytag: member="sbthread.c::sbmsgq_wait" ref="5ef0a82190db1efc97e5921d2f822535" args="(sbmsgq_t *q, size_t *out_len, int sec, int nsec)" -->
void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sbthread_8c.html#5ef0a82190db1efc97e5921d2f822535">sbmsgq_wait</a> (<a class="el" href="sbthread_8h.html#ad7adcc2e5f2fd6d2f429c25a52356ef">sbmsgq_t</a> *q, size_t *out_len, int sec, int nsec)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Wait for a message from a queue. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d6f018be06301acbfd2b41888ca1d345"></a><!-- doxytag: member="sbthread.c::sbevent_init" ref="d6f018be06301acbfd2b41888ca1d345" args="(void)" -->
<a class="el" href="sbthread_8h.html#312dae368aa1662b07f199ea802cdefa">sbevent_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sbthread_8c.html#d6f018be06301acbfd2b41888ca1d345">sbevent_init</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize an event. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="bba6d18d863334a98eecbaf5ffe81ab1"></a><!-- doxytag: member="sbthread.c::sbevent_free" ref="bba6d18d863334a98eecbaf5ffe81ab1" args="(sbevent_t *evt)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sbthread_8c.html#bba6d18d863334a98eecbaf5ffe81ab1">sbevent_free</a> (<a class="el" href="sbthread_8h.html#312dae368aa1662b07f199ea802cdefa">sbevent_t</a> *evt)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free an event. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="89f88d25e27146dc7e4956211e69a6d5"></a><!-- doxytag: member="sbthread.c::sbevent_signal" ref="89f88d25e27146dc7e4956211e69a6d5" args="(sbevent_t *evt)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sbthread_8c.html#89f88d25e27146dc7e4956211e69a6d5">sbevent_signal</a> (<a class="el" href="sbthread_8h.html#312dae368aa1662b07f199ea802cdefa">sbevent_t</a> *evt)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Signal an event. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="9f48001ca75395a3b192902b37edd5e0"></a><!-- doxytag: member="sbthread.c::sbevent_wait" ref="9f48001ca75395a3b192902b37edd5e0" args="(sbevent_t *evt, int sec, int nsec)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sbthread_8c.html#9f48001ca75395a3b192902b37edd5e0">sbevent_wait</a> (<a class="el" href="sbthread_8h.html#312dae368aa1662b07f199ea802cdefa">sbevent_t</a> *evt, int sec, int nsec)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Wait for an event to be signalled. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="690fb21b06b7ef9f958a4a204bc04269"></a><!-- doxytag: member="sbthread.c::sbmtx_init" ref="690fb21b06b7ef9f958a4a204bc04269" args="(void)" -->
<a class="el" href="sbthread_8h.html#21bc1100c4336693a6f25cdeec40cbec">sbmtx_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sbthread_8c.html#690fb21b06b7ef9f958a4a204bc04269">sbmtx_init</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a mutex. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="aca10c92363d8979100c8fddeb783f9a"></a><!-- doxytag: member="sbthread.c::sbmtx_trylock" ref="aca10c92363d8979100c8fddeb783f9a" args="(sbmtx_t *mtx)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sbthread_8c.html#aca10c92363d8979100c8fddeb783f9a">sbmtx_trylock</a> (<a class="el" href="sbthread_8h.html#21bc1100c4336693a6f25cdeec40cbec">sbmtx_t</a> *mtx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Try to acquire a mutex. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="000d9d0610c6b91649edde95e3bafa6c"></a><!-- doxytag: member="sbthread.c::sbmtx_lock" ref="000d9d0610c6b91649edde95e3bafa6c" args="(sbmtx_t *mtx)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sbthread_8c.html#000d9d0610c6b91649edde95e3bafa6c">sbmtx_lock</a> (<a class="el" href="sbthread_8h.html#21bc1100c4336693a6f25cdeec40cbec">sbmtx_t</a> *mtx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Acquire a mutex. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b3fdc55976e2b0581e598bd20187ce3a"></a><!-- doxytag: member="sbthread.c::sbmtx_unlock" ref="b3fdc55976e2b0581e598bd20187ce3a" args="(sbmtx_t *mtx)" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sbthread_8c.html#b3fdc55976e2b0581e598bd20187ce3a">sbmtx_unlock</a> (<a class="el" href="sbthread_8h.html#21bc1100c4336693a6f25cdeec40cbec">sbmtx_t</a> *mtx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Release a mutex. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f1f9eb876ca9fc93d6c548120af14197"></a><!-- doxytag: member="sbthread.c::sbmtx_free" ref="f1f9eb876ca9fc93d6c548120af14197" args="(sbmtx_t *mtx)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sbthread_8c.html#f1f9eb876ca9fc93d6c548120af14197">sbmtx_free</a> (<a class="el" href="sbthread_8h.html#21bc1100c4336693a6f25cdeec40cbec">sbmtx_t</a> *mtx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Dispose of a mutex. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="95c25385f31541c412a458deb9ee94e5"></a><!-- doxytag: member="sbthread.c::sbthread_config" ref="95c25385f31541c412a458deb9ee94e5" args="(sbthread_t *th)" -->
<a class="el" href="structcmd__ln__t.html">cmd_ln_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sbthread_8c.html#95c25385f31541c412a458deb9ee94e5">sbthread_config</a> (<a class="el" href="sbthread_8h.html#068f6028c760eee1e4eb4655ac7e7424">sbthread_t</a> *th)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get configuration object from a thread. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="94e4cf2b756764e453b1469df79b3140"></a><!-- doxytag: member="sbthread.c::sbthread_arg" ref="94e4cf2b756764e453b1469df79b3140" args="(sbthread_t *th)" -->
void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sbthread_8c.html#94e4cf2b756764e453b1469df79b3140">sbthread_arg</a> (<a class="el" href="sbthread_8h.html#068f6028c760eee1e4eb4655ac7e7424">sbthread_t</a> *th)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get argument pointer from a thread. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f13e76cf03ad458f48f9604ec4731bdc"></a><!-- doxytag: member="sbthread.c::sbthread_msgq" ref="f13e76cf03ad458f48f9604ec4731bdc" args="(sbthread_t *th)" -->
<a class="el" href="sbthread_8h.html#ad7adcc2e5f2fd6d2f429c25a52356ef">sbmsgq_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sbthread_8c.html#f13e76cf03ad458f48f9604ec4731bdc">sbthread_msgq</a> (<a class="el" href="sbthread_8h.html#068f6028c760eee1e4eb4655ac7e7424">sbthread_t</a> *th)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get message queue from a thread. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sbthread_8c.html#fae533b302b310a828cf2eed1f2f5995">sbthread_send</a> (<a class="el" href="sbthread_8h.html#068f6028c760eee1e4eb4655ac7e7424">sbthread_t</a> *th, size_t len, void const *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send an asynchronous message to a thread.  <a href="#fae533b302b310a828cf2eed1f2f5995"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2b80d955dab72ff602d9048551dc7489"></a><!-- doxytag: member="sbthread.c::sbthread_free" ref="2b80d955dab72ff602d9048551dc7489" args="(sbthread_t *th)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sbthread_8c.html#2b80d955dab72ff602d9048551dc7489">sbthread_free</a> (<a class="el" href="sbthread_8h.html#068f6028c760eee1e4eb4655ac7e7424">sbthread_t</a> *th)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free a thread object. <br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Simple portable thread functions. 
<p>
<dl class="author" compact><dt><b>Author:</b></dt><dd>David Huggins-Daines &lt;<a href="mailto:dhuggins@cs.cmu.edu">dhuggins@cs.cmu.edu</a>&gt; </dd></dl>

<p>Definition in file <a class="el" href="sbthread_8c-source.html">sbthread.c</a>.</p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="76852d201655b6f08ed6c35f6ebf8b4b"></a><!-- doxytag: member="sbthread.c::sbmsgq_init" ref="76852d201655b6f08ed6c35f6ebf8b4b" args="(size_t depth)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sbthread_8h.html#ad7adcc2e5f2fd6d2f429c25a52356ef">sbmsgq_t</a>* sbmsgq_init           </td>
          <td>(</td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>depth</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create a message queue. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>depth</em>&nbsp;</td><td>Depth of the queue. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="sbthread_8c-source.html#l00444">444</a> of file <a class="el" href="sbthread_8c-source.html">sbthread.c</a>.</p>

<p>References <a class="el" href="ckd__alloc_8h-source.html#l00230">ckd_calloc</a>, and <a class="el" href="ckd__alloc_8c-source.html#l00241">ckd_free()</a>.</p>

<p>Referenced by <a class="el" href="sbthread_8c-source.html#l00406">sbthread_start()</a>.</p>

</div>
</div><p>
<a class="anchor" name="fae533b302b310a828cf2eed1f2f5995"></a><!-- doxytag: member="sbthread.c::sbthread_send" ref="fae533b302b310a828cf2eed1f2f5995" args="(sbthread_t *th, size_t len, void const *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sbthread_send           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="sbthread_8h.html#068f6028c760eee1e4eb4655ac7e7424">sbthread_t</a> *&nbsp;</td>
          <td class="paramname"> <em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void const *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Send an asynchronous message to a thread. 
<p>
Each thread gets a message queue by default, so this is just a wrapper around <a class="el" href="sbthread_8h.html#b0591b5cb626be52dd22edf8fa13a3e3" title="Post a message to a queue.">sbmsgq_send()</a>. 
<p>Definition at line <a class="el" href="sbthread_8c-source.html#l00728">728</a> of file <a class="el" href="sbthread_8c-source.html">sbthread.c</a>.</p>

<p>References <a class="el" href="sbthread_8c-source.html#l00475">sbmsgq_send()</a>.</p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sat Dec 3 20:28:40 2011 for SphinxBase by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.7.1 </small></address>
</body>
</html>
